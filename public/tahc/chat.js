const _0x28df0b = _0x51d0; (function (_0xd75b94, _0x1342e5) { const _0x373c1f = _0x51d0, _0x374c3e = _0xd75b94(); while (!![]) { try { const _0x13a1e3 = -parseInt(_0x373c1f(0x1e0)) / 0x1 + -parseInt(_0x373c1f(0x263)) / 0x2 + parseInt(_0x373c1f(0x19f)) / 0x3 * (-parseInt(_0x373c1f(0x1fe)) / 0x4) + -parseInt(_0x373c1f(0x144)) / 0x5 + parseInt(_0x373c1f(0x25c)) / 0x6 * (parseInt(_0x373c1f(0x216)) / 0x7) + parseInt(_0x373c1f(0x271)) / 0x8 + -parseInt(_0x373c1f(0x256)) / 0x9 * (-parseInt(_0x373c1f(0x1c8)) / 0xa); if (_0x13a1e3 === _0x1342e5) break; else _0x374c3e['push'](_0x374c3e['shift']()); } catch (_0x42156d) { _0x374c3e['push'](_0x374c3e['shift']()); } } }(_0x3c8b, 0xf2154)); import { initializeApp } from 'https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js'; import { getFirestore, collection, addDoc, query, where, orderBy, onSnapshot, serverTimestamp, doc, setDoc, getDocs, updateDoc, getDoc } from 'https://www.gstatic.com/firebasejs/12.1.0/firebase-firestore.js'; import { getAuth, signInAnonymously, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/12.1.0/firebase-auth.js'; const firebaseConfig = { 'apiKey': _0x28df0b(0x205), 'authDomain': _0x28df0b(0x21f), 'projectId': _0x28df0b(0x159), 'storageBucket': _0x28df0b(0x235), 'messagingSenderId': _0x28df0b(0x1b2), 'appId': _0x28df0b(0x175), 'measurementId': _0x28df0b(0x20d) }, app = initializeApp(firebaseConfig), db = getFirestore(app), auth = getAuth(); let me = { 'uid': null, 'name': sessionStorage[_0x28df0b(0x253)](_0x28df0b(0x16a)) || '', 'tag': sessionStorage['getItem'](_0x28df0b(0x177)) || '', 'avatar': '?' }, current = { 'type': 'public', 'id': _0x28df0b(0x1ba), 'title': _0x28df0b(0x157) }, unsubMsgs = null, unsubMyRooms = null, unsubUsers = null, lastMessageTime = 0x0, messageHistory = [], mutedUntil = 0x0, roomCache = {}, activeListeners = {}; const COOLDOWN_MS = 0xbb8, MUTE_DURATION_MS = 0x927c0, SPAM_THRESHOLD = 0x5, swearingBlacklist = ['fuck', _0x28df0b(0x14e), _0x28df0b(0x1a9), _0x28df0b(0x156), _0x28df0b(0x202), 'dickhead', 'asshole', 'motherfucker', 'bullshit', 'dumbass', _0x28df0b(0x1da), _0x28df0b(0x1c5), _0x28df0b(0x26e), _0x28df0b(0x1c0), _0x28df0b(0x276), 'pussy', _0x28df0b(0x1e6), 'dick', 'penis', _0x28df0b(0x19e), _0x28df0b(0x19c), 'boobs', _0x28df0b(0x1d2), _0x28df0b(0x1a0), _0x28df0b(0x1ce), _0x28df0b(0x20b), 'horny', _0x28df0b(0x184), _0x28df0b(0x26f), _0x28df0b(0x25a), 'rape', _0x28df0b(0x160), _0x28df0b(0x14c), _0x28df0b(0x1ee), _0x28df0b(0x296), _0x28df0b(0x149), _0x28df0b(0x1a3)]; let isAdmin = ![], adminCheckComplete = ![]; const emojis = ['ðŸ˜€', 'ðŸ˜ƒ', 'ðŸ˜„', 'ðŸ˜', 'ðŸ˜†', 'ðŸ˜…', 'ðŸ¤£', 'ðŸ˜‚', 'ðŸ™‚', 'ðŸ™ƒ', 'ðŸ˜‰', 'ðŸ˜Š', 'ðŸ˜‡', 'ðŸ¥°', 'ðŸ˜', 'ðŸ¤©', 'ðŸ˜˜', 'ðŸ˜—', 'ðŸ˜š', 'ðŸ˜™', 'ðŸ¥²', 'ðŸ˜‹', 'ðŸ˜›', 'ðŸ˜œ', 'ðŸ¤ª', 'ðŸ˜', 'ðŸ¤‘', 'ðŸ¤—', 'ðŸ¤­', 'ðŸ¤«', 'ðŸ¤”', 'ðŸ¤', 'ðŸ¤¨', 'ðŸ˜', 'ðŸ˜‘', 'ðŸ˜¶', 'ðŸ˜', 'ðŸ˜’', 'ðŸ™„', 'ðŸ˜¬', 'ðŸ¤¥', 'ðŸ˜Œ', 'ðŸ˜”', 'ðŸ˜ª', 'ðŸ¤¤', 'ðŸ˜´', 'ðŸ˜·', 'ðŸ¤’', 'ðŸ¤•', 'ðŸ¤¢', 'ðŸ¤®', 'ðŸ¤§', 'ðŸ¥µ', 'ðŸ¥¶', 'ðŸ¥´', 'ðŸ˜µ', 'ðŸ¤¯', 'ðŸ¤ ', 'ðŸ¥³', 'ðŸ¥¸', 'ðŸ˜Ž', 'ðŸ¤“', 'ðŸ§', 'ðŸ˜•', 'ðŸ˜Ÿ', 'ðŸ™', 'â˜¹ï¸', 'ðŸ˜®', 'ðŸ˜¯', 'ðŸ˜²', 'ðŸ˜³', 'ðŸ¥º', 'ðŸ˜¦', 'ðŸ˜§', 'ðŸ˜¨', 'ðŸ˜°', 'ðŸ˜¥', 'ðŸ˜¢', 'ðŸ˜­', 'ðŸ˜±', 'ðŸ˜–', 'ðŸ˜£', 'ðŸ˜ž', 'ðŸ˜“', 'ðŸ˜©', 'ðŸ˜«', 'ðŸ¥±', 'ðŸ˜¤', 'ðŸ˜¡', 'ðŸ˜ ', 'ðŸ¤¬', 'ðŸ˜ˆ', 'ðŸ‘¿', 'ðŸ’€', 'â˜ ï¸', 'ðŸ’©', 'ðŸ¤¡', 'ðŸ‘¹', 'ðŸ‘º', 'ðŸ‘»', 'ðŸ‘½', 'ðŸ‘¾', 'ðŸ¤–', 'ðŸŽƒ', 'ðŸ˜º', 'â¤ï¸', 'ðŸ§¡', 'ðŸ’›', 'ðŸ’š', 'ðŸ’™', 'ðŸ’œ', 'ðŸ–¤', 'ðŸ¤', 'ðŸ¤Ž', 'ðŸ’”', 'â£ï¸', 'ðŸ’•', 'ðŸ’–', 'ðŸ’—', 'ðŸ’˜', 'ðŸ’', 'ðŸ’Ÿ', 'â™¥ï¸', 'ðŸ’¯', 'ðŸ‘', 'ðŸ‘Ž', 'âœŒï¸', 'ðŸ¤ž', 'ðŸ¤Ÿ', 'ðŸ¤˜', 'ðŸ¤™', 'ðŸ‘ˆ', 'ðŸ‘‰', 'ðŸ‘†', 'ðŸ‘‡', 'â˜ï¸', 'âœ‹', 'ðŸ¤š', 'ðŸ–ï¸', 'ðŸ––', 'ðŸ‘‹', 'ðŸ¤›', 'ðŸ¤œ', 'âœŠ', 'ðŸ‘Š', 'ðŸ’ª', 'ðŸ™', 'âœ¨', 'â­', 'ðŸŒŸ', 'ðŸ’¥', 'ðŸ”¥', 'â„ï¸', 'âš¡', 'ðŸŒˆ', 'â˜€ï¸', 'â˜ï¸'], usersPanel = document['getElementById'](_0x28df0b(0x1d3)), toggleUsersBtn = document[_0x28df0b(0x1e3)](_0x28df0b(0x248)), usersList = document[_0x28df0b(0x1e3)](_0x28df0b(0x250)), chatTitle = document[_0x28df0b(0x1e3)](_0x28df0b(0x179)), messagesEl = document[_0x28df0b(0x1e3)](_0x28df0b(0x1af)), messageInput = document['getElementById']('messageInput'), sendBtn = document[_0x28df0b(0x1e3)](_0x28df0b(0x280)), publicBtn = document[_0x28df0b(0x1e3)](_0x28df0b(0x1d1)), myChats = document['getElementById'](_0x28df0b(0x18d)), startDmBtn = document[_0x28df0b(0x1e3)](_0x28df0b(0x1b5)), createGroupBtn = document[_0x28df0b(0x1e3)](_0x28df0b(0x231)), changeNameBtn = document[_0x28df0b(0x1e3)](_0x28df0b(0x22e)), renameGroupBtn = document[_0x28df0b(0x1e3)](_0x28df0b(0x154)), adminPanelBtn = document[_0x28df0b(0x1e3)]('adminPanelBtn'), adminKeyBtn = document[_0x28df0b(0x1e3)](_0x28df0b(0x27b)), modalOverlay = document[_0x28df0b(0x1e3)](_0x28df0b(0x1cd)), modalTitle = document[_0x28df0b(0x1e3)]('modalTitle'), modalBody = document['getElementById'](_0x28df0b(0x188)), modalCancel = document[_0x28df0b(0x1e3)](_0x28df0b(0x1b9)), modalSave = document[_0x28df0b(0x1e3)]('modalSave'); async function requestNotificationPermission() { const _0x3c8afc = _0x28df0b; if ('Notification' in window && Notification[_0x3c8afc(0x28d)] === 'default') await Notification[_0x3c8afc(0x143)](); } function showMessageNotification(_0x45a977, _0x353e8e) { const _0x30dbde = _0x28df0b; if (_0x45a977[_0x30dbde(0x1ca)] === me[_0x30dbde(0x1ca)] || _0x353e8e === _0x30dbde(0x1ba) || !(_0x30dbde(0x22a) in window) || Notification[_0x30dbde(0x28d)] !== _0x30dbde(0x24a)) return; let _0x1d8cf7, _0x4494dc; const _0x3f49d0 = sanitizeInput(_0x45a977[_0x30dbde(0x170)] || _0x30dbde(0x153), 0x14), _0x6c2e14 = sanitizeInput(_0x45a977['tag'] || '0000', 0xa), _0x4fb548 = sanitizeInput(_0x45a977[_0x30dbde(0x252)] || '', 0x32), _0x2b28aa = sanitizeInput(me[_0x30dbde(0x170)] || _0x30dbde(0x155), 0x14), _0x24755e = safeUsername(_0x3f49d0, _0x6c2e14); if (_0x353e8e === 'dm') _0x1d8cf7 = 'New\x20Direct\x20Message', _0x4494dc = _0x30dbde(0x27e) + _0x2b28aa + '!\x20' + _0x24755e + '\x20has\x20just\x20DM\x27ed\x20you:\x0a\x27' + _0x4fb548 + '\x27'; else _0x353e8e === _0x30dbde(0x230) && (_0x1d8cf7 = _0x30dbde(0x224), _0x4494dc = _0x30dbde(0x27e) + _0x2b28aa + '!\x20' + _0x24755e + _0x30dbde(0x23c) + _0x4fb548 + '\x27'); if (_0x1d8cf7 && _0x4494dc) { const _0x36c096 = new Notification(_0x1d8cf7, { 'body': _0x4494dc, 'tag': _0x30dbde(0x24b) + _0x353e8e + '-' + _0x45a977['uid'], 'requireInteraction': ![] }); _0x36c096['onclick'] = () => { const _0x3b98e3 = _0x30dbde; window[_0x3b98e3(0x165)](), _0x36c096['close'](); }, setTimeout(() => _0x36c096[_0x30dbde(0x166)](), 0x1388); } } function sanitizeInput(_0x274e7c, _0x3ddefb = 0x32) { const _0x2a14d3 = _0x28df0b; if (typeof _0x274e7c !== _0x2a14d3(0x228)) return ''; return _0x274e7c[_0x2a14d3(0x25b)]()['substring'](0x0, _0x3ddefb); } function validateId(_0x19db2) { const _0x331e3f = _0x28df0b; if (typeof _0x19db2 !== _0x331e3f(0x228)) return ![]; return /^[a-zA-Z0-9_-]+$/['test'](_0x19db2); } function createTextElement(_0x264a6f, _0x556b30, _0x14e2b2 = null) { const _0x2aab02 = _0x28df0b, _0x3d6ada = document[_0x2aab02(0x1f4)](_0x264a6f); _0x3d6ada[_0x2aab02(0x1ac)] = _0x556b30; if (_0x14e2b2) _0x3d6ada['className'] = _0x14e2b2; return _0x3d6ada; } function safeSetAttribute(_0x130c7b, _0x36a0b2, _0x3f2e6b) { const _0x61aad5 = _0x28df0b; if (typeof _0x36a0b2 !== _0x61aad5(0x228) || typeof _0x3f2e6b !== _0x61aad5(0x228)) return; const _0x4f1af0 = ['id', _0x61aad5(0x225), 'data-uid', _0x61aad5(0x29b), _0x61aad5(0x294), 'type', _0x61aad5(0x170), 'value', _0x61aad5(0x15e), _0x61aad5(0x206)]; if (_0x4f1af0[_0x61aad5(0x1fd)](_0x36a0b2)) { const _0x4c64dc = _0x3f2e6b[_0x61aad5(0x1ec)](/[<>"']/g, ''); _0x130c7b[_0x61aad5(0x288)](_0x36a0b2, _0x4c64dc); } } function avatarLetter(_0x9817b5) { const _0x10ab64 = _0x28df0b, _0x4dbbc8 = sanitizeInput(_0x9817b5); return (_0x4dbbc8[0x0] || '?')[_0x10ab64(0x237)](); } function randomTag() { const _0x5667af = _0x28df0b; return Math[_0x5667af(0x232)](0x3e8 + Math[_0x5667af(0x142)]() * 0x2328)['toString'](); } function safeUsername(_0x15b9f9, _0x302885) { const _0xb23c9a = sanitizeInput(_0x15b9f9, 0x14), _0x534353 = sanitizeInput(_0x302885, 0xa); return _0xb23c9a + '#' + _0x534353; } function formatTimestamp(_0x1f7132) { const _0x16ffe8 = _0x28df0b; if (!_0x1f7132) return ''; const _0x4687d0 = _0x1f7132['toDate'] ? _0x1f7132[_0x16ffe8(0x147)]() : new Date(_0x1f7132), _0x28a5db = new Date(), _0x21c046 = new Date(_0x28a5db[_0x16ffe8(0x1b1)](), _0x28a5db[_0x16ffe8(0x272)](), _0x28a5db[_0x16ffe8(0x187)]()), _0x3ae7c9 = new Date(_0x21c046); _0x3ae7c9[_0x16ffe8(0x15b)](_0x3ae7c9[_0x16ffe8(0x187)]() - 0x1); const _0x118c3d = new Date(_0x4687d0['getFullYear'](), _0x4687d0[_0x16ffe8(0x272)](), _0x4687d0[_0x16ffe8(0x187)]()), _0x400cd9 = _0x4687d0['toLocaleTimeString']([], { 'hour': _0x16ffe8(0x178), 'minute': _0x16ffe8(0x178), 'hour12': !![] }); if (_0x118c3d[_0x16ffe8(0x236)]() === _0x21c046[_0x16ffe8(0x236)]()) return _0x400cd9; else { if (_0x118c3d[_0x16ffe8(0x236)]() === _0x3ae7c9[_0x16ffe8(0x236)]()) return _0x16ffe8(0x1d4) + _0x400cd9; else { const _0x41eb8b = (_0x4687d0[_0x16ffe8(0x272)]() + 0x1)['toString']()[_0x16ffe8(0x193)](0x2, '0'), _0x12ad47 = _0x4687d0[_0x16ffe8(0x187)]()['toString']()[_0x16ffe8(0x193)](0x2, '0'), _0x38d8a8 = _0x4687d0['getFullYear']()[_0x16ffe8(0x28f)]()[_0x16ffe8(0x16e)](-0x2); return _0x41eb8b + '/' + _0x12ad47 + '/' + _0x38d8a8 + ',\x20' + _0x400cd9; } } } function filterSwearing(_0x4a6bf8) { const _0x13732d = _0x28df0b; let _0x5319bb = sanitizeInput(_0x4a6bf8, 0x77); return swearingBlacklist[_0x13732d(0x1b7)](_0x319fc2 => { const _0x17b6eb = _0x13732d, _0x28a21c = new RegExp(_0x17b6eb(0x1b6) + _0x319fc2 + _0x17b6eb(0x186), 'gi'); _0x5319bb = _0x5319bb[_0x17b6eb(0x1ec)](_0x28a21c, _0x48c28c => '*'[_0x17b6eb(0x173)](_0x48c28c[_0x17b6eb(0x282)])); }), _0x5319bb; } async function checkAdminStatus() { const _0x502106 = _0x28df0b; if (!me[_0x502106(0x1ca)]) return ![]; try { const _0x275f92 = query(collection(db, _0x502106(0x244)), where('uid', '==', me['uid'])), _0x1d0493 = await getDocs(_0x275f92); if (!_0x1d0493[_0x502106(0x22d)]) { isAdmin = !![]; const _0x13e6c7 = _0x1d0493[_0x502106(0x273)][0x0][_0x502106(0x279)](); return me[_0x502106(0x170)] = _0x502106(0x1f6), me['tag'] = '3164', me[_0x502106(0x16d)] = !![], me[_0x502106(0x1a5)] = _0x13e6c7[_0x502106(0x1a5)], sessionStorage[_0x502106(0x192)]('username', me[_0x502106(0x170)]), sessionStorage[_0x502106(0x192)](_0x502106(0x177), me[_0x502106(0x26c)]), updateOwnerBadge(), !![]; } return ![]; } catch (_0x1c406e) { return console[_0x502106(0x242)]('Admin\x20check\x20error:', _0x1c406e), ![]; } } function updateOwnerBadge() { const _0x1339b9 = _0x28df0b; console[_0x1339b9(0x21a)](_0x1339b9(0x1a1), { 'isOwner': me[_0x1339b9(0x1a5)], 'uid': me[_0x1339b9(0x1ca)] }); if (!me[_0x1339b9(0x1a5)]) { console[_0x1339b9(0x21a)](_0x1339b9(0x191)); return; } const _0x5ca90f = document[_0x1339b9(0x151)](_0x1339b9(0x1cb) + me[_0x1339b9(0x1ca)] + '\x22]'); console[_0x1339b9(0x21a)]('Found\x20user\x20row:', _0x5ca90f); if (_0x5ca90f) { const _0x5868ac = _0x5ca90f[_0x1339b9(0x151)]('.user-name'); console[_0x1339b9(0x21a)](_0x1339b9(0x246), _0x5868ac); if (_0x5868ac) { _0x5868ac['textContent'] = ''; const _0x5043fc = document['createElement'](_0x1339b9(0x258)); _0x5043fc['id'] = 'owner-badge', _0x5043fc[_0x1339b9(0x1ac)] = _0x1339b9(0x1f6), _0x5868ac['appendChild'](_0x5043fc), _0x5868ac['appendChild'](document[_0x1339b9(0x1ea)](_0x1339b9(0x168))), console[_0x1339b9(0x21a)](_0x1339b9(0x278)); } } else console[_0x1339b9(0x21a)](_0x1339b9(0x18f)); } function updateAdminUI() { const _0x44cf71 = _0x28df0b, _0x2be8fb = document[_0x44cf71(0x1e3)](_0x44cf71(0x1f0)), _0x3218c4 = document[_0x44cf71(0x1e3)](_0x44cf71(0x27b)); if (_0x2be8fb) _0x2be8fb['style'][_0x44cf71(0x268)] = isAdmin && adminCheckComplete ? _0x44cf71(0x200) : 'none'; if (_0x3218c4) _0x3218c4[_0x44cf71(0x194)][_0x44cf71(0x268)] = !isAdmin && adminCheckComplete ? _0x44cf71(0x200) : _0x44cf71(0x1a7); } function _0x51d0(_0x1cd26c, _0x5ef866) { _0x1cd26c = _0x1cd26c - 0x140; const _0x3c8ba7 = _0x3c8b(); let _0x51d0ac = _0x3c8ba7[_0x1cd26c]; return _0x51d0ac; } function showStatusMessage(_0x6cbcf6, _0xb07f4f = _0x28df0b(0x1be)) { const _0xdee9f6 = _0x28df0b, _0xd83165 = document[_0xdee9f6(0x1f4)](_0xdee9f6(0x29a)); _0xd83165[_0xdee9f6(0x194)][_0xdee9f6(0x27f)] = 'position:fixed;top:20px;right:20px;padding:12px\x2020px;border-radius:8px;color:white;font-weight:500;z-index:10000;animation:slideIn\x200.3s\x20ease-out;max-width:300px;word-wrap:break-word;'; if (_0xb07f4f === _0xdee9f6(0x242)) _0xd83165['style'][_0xdee9f6(0x234)] = _0xdee9f6(0x18c); else { if (_0xb07f4f === _0xdee9f6(0x1f9)) _0xd83165['style']['background'] = _0xdee9f6(0x262); else _0xd83165[_0xdee9f6(0x194)][_0xdee9f6(0x234)] = _0xdee9f6(0x1ad); } _0xd83165[_0xdee9f6(0x1ac)] = sanitizeInput(_0x6cbcf6, 0xc8), document[_0xdee9f6(0x1c2)][_0xdee9f6(0x1db)](_0xd83165), setTimeout(() => { const _0x2967d5 = _0xdee9f6; _0xd83165[_0x2967d5(0x194)][_0x2967d5(0x1c4)] = _0x2967d5(0x182), setTimeout(() => _0xd83165[_0x2967d5(0x17b)](), 0x12c); }, 0xbb8); } function checkSpamProtection(_0x3b0bc5) { const _0x5ef4cc = _0x28df0b, _0xbbbd41 = Date[_0x5ef4cc(0x264)](); if (_0xbbbd41 < mutedUntil) { const _0x394b01 = Math['ceil']((mutedUntil - _0xbbbd41) / 0x3e8); return showStatusMessage(_0x5ef4cc(0x180) + _0x394b01 + _0x5ef4cc(0x24f), _0x5ef4cc(0x242)), ![]; } const _0x17e252 = _0xbbbd41 - lastMessageTime; if (_0x17e252 < COOLDOWN_MS) { const _0x2f377b = Math['ceil']((COOLDOWN_MS - _0x17e252) / 0x3e8); return showStatusMessage(_0x5ef4cc(0x293) + _0x2f377b + '\x20seconds\x20before\x20sending\x20another\x20message', _0x5ef4cc(0x1f9)), ![]; } messageHistory[_0x5ef4cc(0x162)]({ 'text': _0x3b0bc5['toLowerCase']()[_0x5ef4cc(0x25b)](), 'timestamp': _0xbbbd41 }); if (messageHistory[_0x5ef4cc(0x282)] > 0xa) messageHistory[_0x5ef4cc(0x1b4)](); const _0x4ca31e = messageHistory[_0x5ef4cc(0x20c)](_0x40df2b => _0x40df2b[_0x5ef4cc(0x252)] === _0x3b0bc5[_0x5ef4cc(0x281)]()[_0x5ef4cc(0x25b)]() && _0xbbbd41 - _0x40df2b['timestamp'] < 0xea60); if (_0x4ca31e[_0x5ef4cc(0x282)] >= SPAM_THRESHOLD) return mutedUntil = _0xbbbd41 + MUTE_DURATION_MS, showStatusMessage(_0x5ef4cc(0x1aa), 'error'), messageHistory = messageHistory[_0x5ef4cc(0x20c)](_0x5828e8 => _0x5828e8[_0x5ef4cc(0x252)] !== _0x3b0bc5[_0x5ef4cc(0x281)]()[_0x5ef4cc(0x25b)]()), ![]; return lastMessageTime = _0xbbbd41, !![]; } function updateSendButtonState() { const _0x58c12e = _0x28df0b, _0x38ff0a = Date[_0x58c12e(0x264)](), _0x496212 = messageInput[_0x58c12e(0x15f)][_0x58c12e(0x25b)]() && _0x38ff0a >= mutedUntil && _0x38ff0a - lastMessageTime >= COOLDOWN_MS; sendBtn[_0x58c12e(0x1fc)] = !_0x496212, sendBtn[_0x58c12e(0x194)][_0x58c12e(0x287)] = _0x496212 ? '1' : _0x58c12e(0x1b3), sendBtn['style']['cursor'] = _0x496212 ? _0x58c12e(0x1c1) : _0x58c12e(0x14f); if (_0x38ff0a < mutedUntil) { const _0x21ef30 = Math[_0x58c12e(0x285)]((mutedUntil - _0x38ff0a) / 0x3e8); messageInput['placeholder'] = _0x58c12e(0x277) + _0x21ef30 + '\x20seconds...', messageInput[_0x58c12e(0x1fc)] = !![]; } else messageInput[_0x58c12e(0x15e)] = 'Type\x20a\x20message...', messageInput[_0x58c12e(0x1fc)] = ![]; } function addEmojiPicker() { const _0x3ccc71 = _0x28df0b, _0x49402d = document[_0x3ccc71(0x1f4)](_0x3ccc71(0x29a)); _0x49402d['id'] = _0x3ccc71(0x227), _0x49402d['style'][_0x3ccc71(0x27f)] = 'position:absolute;bottom:60px;right:10px;background:var(--surface-hover);border:1px\x20solid\x20#ccc;border-radius:8px;padding:10px;max-width:300px;max-height:200px;overflow-y:auto;display:none;z-index:9999999;box-shadow:0\x204px\x2012px\x20rgba(0,0,0,0.15);', emojis[_0x3ccc71(0x1b7)](_0x8ae38 => { const _0xc00c8f = _0x3ccc71, _0x40a243 = document[_0xc00c8f(0x1f4)]('button'); _0x40a243['textContent'] = _0x8ae38, _0x40a243[_0xc00c8f(0x194)][_0xc00c8f(0x27f)] = 'border:none;background:none;font-size:20px;margin:2px;cursor:pointer;padding:4px;border-radius:4px;', _0x40a243[_0xc00c8f(0x176)] = () => { const _0xeade98 = _0xc00c8f; messageInput[_0xeade98(0x15f)]['length'] < 0x77 && (messageInput[_0xeade98(0x15f)] += _0x8ae38, _0x1794eb(), _0x49402d[_0xeade98(0x194)][_0xeade98(0x268)] = _0xeade98(0x1a7), messageInput[_0xeade98(0x165)]()); }, _0x49402d[_0xc00c8f(0x1db)](_0x40a243); }), document[_0x3ccc71(0x1c2)][_0x3ccc71(0x1db)](_0x49402d); const _0x78c947 = document[_0x3ccc71(0x1f4)](_0x3ccc71(0x247)); _0x78c947[_0x3ccc71(0x1ac)] = 'ðŸ˜€', _0x78c947[_0x3ccc71(0x194)][_0x3ccc71(0x27f)] = _0x3ccc71(0x25f), _0x78c947['onclick'] = () => { const _0x51feca = _0x3ccc71; _0x49402d[_0x51feca(0x194)][_0x51feca(0x268)] = _0x49402d[_0x51feca(0x194)][_0x51feca(0x268)] === 'none' ? _0x51feca(0x200) : _0x51feca(0x1a7); }; const _0x57d636 = document[_0x3ccc71(0x1f4)]('div'); _0x57d636['id'] = 'charCounter', _0x57d636[_0x3ccc71(0x194)][_0x3ccc71(0x27f)] = 'position:absolute;right:10px;bottom:450px;transform:translateY(-50%);font-size:12px;color:var(--text-muted);pointer-events:none;opacity:0;transition:opacity\x200.2s\x20ease;'; const _0x46d6de = messageInput[_0x3ccc71(0x295)]; _0x46d6de[_0x3ccc71(0x194)][_0x3ccc71(0x17c)] = _0x3ccc71(0x24e), _0x46d6de[_0x3ccc71(0x1db)](_0x78c947), _0x46d6de[_0x3ccc71(0x1db)](_0x57d636); function _0x1794eb() { const _0xc9820b = _0x3ccc71, _0x3c106b = messageInput['value']['length']; _0x57d636[_0xc9820b(0x1ac)] = _0x3c106b + _0xc9820b(0x164); if (_0x3c106b >= 0x5a) { _0x57d636[_0xc9820b(0x194)][_0xc9820b(0x287)] = '1'; if (_0x3c106b > 0x64) _0x57d636[_0xc9820b(0x194)][_0xc9820b(0x27a)] = _0x3c106b >= 0x77 ? '#ff4444' : _0xc9820b(0x262); else _0x57d636[_0xc9820b(0x194)][_0xc9820b(0x27a)] = _0xc9820b(0x210); } else _0x57d636[_0xc9820b(0x194)][_0xc9820b(0x287)] = '0'; updateSendButtonState(); } messageInput['addEventListener'](_0x3ccc71(0x21b), _0x2d8d84 => { const _0x2f61c9 = _0x3ccc71; if (_0x2d8d84[_0x2f61c9(0x174)][_0x2f61c9(0x15f)]['length'] > 0x77) _0x2d8d84['target'][_0x2f61c9(0x15f)] = _0x2d8d84[_0x2f61c9(0x174)][_0x2f61c9(0x15f)][_0x2f61c9(0x27d)](0x0, 0x77); _0x1794eb(); }), messageInput['addEventListener']('focus', () => { const _0x1c4c4b = _0x3ccc71, _0x2b3cba = messageInput[_0x1c4c4b(0x15f)][_0x1c4c4b(0x282)]; if (_0x2b3cba >= 0x5a) _0x57d636[_0x1c4c4b(0x194)]['opacity'] = '1'; }), messageInput[_0x3ccc71(0x269)]('blur', () => { const _0xef0619 = _0x3ccc71, _0x5f2fdb = messageInput[_0xef0619(0x15f)][_0xef0619(0x282)]; if (_0x5f2fdb < 0x5a) _0x57d636['style'][_0xef0619(0x287)] = '0'; }), _0x1794eb(), window[_0x3ccc71(0x243)] = _0x1794eb, setInterval(updateSendButtonState, 0x3e8), document[_0x3ccc71(0x269)](_0x3ccc71(0x16c), _0x23dcd2 => { const _0xf6bc3b = _0x3ccc71; if (!_0x49402d[_0xf6bc3b(0x220)](_0x23dcd2[_0xf6bc3b(0x174)]) && _0x23dcd2[_0xf6bc3b(0x174)] !== _0x78c947) _0x49402d[_0xf6bc3b(0x194)][_0xf6bc3b(0x268)] = _0xf6bc3b(0x1a7); }); } function createSafeModal(_0x544df9, _0x4a0f6e, _0x26e9cf) { const _0x2fc535 = _0x28df0b; modalTitle['textContent'] = sanitizeInput(_0x544df9, 0x64), modalBody[_0x2fc535(0x158)] = ''; const _0x3933c5 = _0x4a0f6e(); modalBody[_0x2fc535(0x1db)](_0x3933c5), modalOverlay[_0x2fc535(0x194)][_0x2fc535(0x268)] = 'flex'; const _0x850252 = modalBody[_0x2fc535(0x151)](_0x2fc535(0x21b)); if (_0x850252) setTimeout(() => _0x850252['focus'](), 0x0); modalSave['onclick'] = async () => { if (_0x26e9cf) await _0x26e9cf(); }; } function closeModal() { const _0x804f1 = _0x28df0b; modalOverlay[_0x804f1(0x194)][_0x804f1(0x268)] = 'none', modalBody['innerHTML'] = '', modalSave[_0x804f1(0x176)] = null; } modalCancel['onclick'] = closeModal; function _0x3c8b() { const _0xa44980 = ['log', 'input', 'Group\x20create\x20error:', 'role', 'active', 'chatithink-71d51.firebaseapp.com', 'contains', 'padding:0.7rem;margin-bottom:0.5rem;background:var(--surface);border-radius:6px;display:flex;justify-content:space-between;align-items:center;border-left:3px\x20solid\x20', 'exists', 'maxLength', 'New\x20Group\x20Message', 'class', 'side-title', 'emojiPicker', 'string', 'Failed\x20to\x20load\x20messages', 'Notification', 'margin-top:1rem;padding:0.5rem;background:var(--surface-hover);border-radius:4px;font-size:0.85rem;color:var(--text-muted);text-align:center;', 'label', 'empty', 'changeNameBtn', 'find', 'group', 'createGroupBtn', 'floor', '\x20â€¢\x20', 'background', 'chatithink-71d51.firebasestorage.app', 'getTime', 'toUpperCase', 'margin-bottom:1rem;color:var(--primary);font-size:1.3rem;', 'ðŸ“Š\x20User\x20Management', 'classList', 'docId', '\x20has\x20sent\x20a\x20group\x20message:\x0a\x27', 'ðŸ‘‘\x20Administrator\x20Dashboard', 'cloneNode', 'toggle', 'updatedAt', 'Admin\x20key\x20verification\x20error:', 'error', 'updateCharCount', 'admins', '#F44336', 'Found\x20name\x20element:', 'button', 'toggleUsers', 'grp_', 'granted', 'message-', 'Unban', 'array-contains', 'relative', '\x20more\x20seconds', 'usersList', 'Status\x20update\x20error:', 'text', 'getItem', 'Rename\x20Group', 'user-meta', '2196207AeaNbu', 'var(--primary)', 'span', 'margin-top:1rem;', 'strip', 'trim', '24648dayjTO', 'unmuted', 'Rename\x20error:', 'position:absolute;right:20px;bottom:40px;transform:translateY(-50%);border:none;background:var(--surface);font-size:20px;cursor:pointer;padding:5px;border-radius:4px;z-index:9999;', 'radio', 'hint', '#ff8800', '1858558MKAgXT', 'now', '@keyframes\x20slideIn{from{transform:translateX(100%);opacity:0}to{transform:translateX(0);opacity:1}}@keyframes\x20slideOut{from{transform:translateX(0);opacity:1}to{transform:translateX(100%);opacity:0}}@keyframes\x20spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}', 'margin-bottom:0.8rem;font-size:1.1rem;', 'online', 'display', 'addEventListener', 'sort', 'scrollHeight', 'tag', 'usernameInput', 'whore', 'naked', 'list', '13019064jCNqVB', 'getMonth', 'docs', 'Ban\x20error:', 'map', 'cunt', 'Muted\x20for\x20', 'Badge\x20applied\x20successfully', 'data', 'color', 'adminKeyBtn', 'timestamp', 'substring', 'Hey\x20', 'cssText', 'sendBtn', 'toLowerCase', 'length', 'scrollTop', 'shiftKey', 'ceil', 'className', 'opacity', 'setAttribute', 'Enter\x20Admin\x20Key', 'preventDefault', 'bubble', 'room-btn', 'permission', 'fragment', 'toString', 'rooms', 'size', 'Unmute', 'Please\x20wait\x20', 'data-tag', 'parentElement', 'suicide', ';color:white;font-weight:500;', 'font-size:1.2rem;font-weight:bold;color:var(--primary);', 'test', 'div', 'data-name', 'password', 'font-size:12px;color:var(--text-muted);margin-top:5px;', 'random', 'requestPermission', '2037430EhsGGN', 'No\x20other\x20users\x20yet.', 'Error\x20loading\x20user\x20profile:', 'toDate', 'type', 'bomb', 'open', 'added', 'die', 'newIndex', 'shit', 'not-allowed', 'Set\x20Username', 'querySelector', 'Profile\x20update\x20error:', 'Unknown', 'renameGroupBtn', 'User', 'bitch', 'General\x20Chat', 'innerHTML', 'chatithink-71d51', '3164', 'setDate', 'input[name=\x22dmTarget\x22]:checked', 'padding:0.3rem\x200.6rem;border:none;border-radius:4px;font-size:0.8rem;cursor:pointer;background:', 'placeholder', 'value', 'murder', '\x20(you)', 'push', 'roombtn_', '/119', 'focus', 'close', 'New\x20group\x20name', '\x20[Owner]\x20#3164\x20(you)', 'Failed\x20to\x20verify\x20key', 'username', 'unbanned', 'click', 'isAdmin', 'slice', '#2196F3', 'name', '\x0a\x20\x20\x20\x20<div\x20style=\x22display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;gap:1rem;\x22>\x0a\x20\x20\x20\x20\x20\x20<div\x20style=\x22width:50px;height:50px;border:4px\x20solid\x20var(--surface-hover);border-top:4px\x20solid\x20var(--primary);border-radius:50%;animation:spin\x201s\x20linear\x20infinite;\x22></div>\x0a\x20\x20\x20\x20\x20\x20<div\x20style=\x22color:var(--text-muted);font-size:0.9rem;\x22>Loading...</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20', 'catch', 'repeat', 'target', '1:772161335544:web:bc98e4c0ff896829d08b0d', 'onclick', 'usertag', '2-digit', 'chatTitle', 'display:flex;align-items:center;gap:0.5rem;flex:1;', 'remove', 'position', '#FF9800', 'Failed\x20to\x20update\x20mute\x20status', 'Group\x20name', 'You\x20are\x20muted\x20for\x20', 'seconds', 'slideOut\x200.3s\x20ease-in\x20forwards', 'status', 'nude', 'groupName', '\x5cw*\x5cb', 'getDate', 'modalBody', 'display:grid;grid-template-columns:1fr\x201fr;gap:0.5rem;margin-bottom:1rem;', 'offline', 'title', '#ff4444', 'myChats', 'add', 'User\x20row\x20not\x20found\x20yet\x20-\x20will\x20be\x20applied\x20on\x20next\x20render', '#666', 'Not\x20owner,\x20skipping\x20badge', 'setItem', 'padStart', 'style', 'No\x20other\x20users.', 'text-decoration:line-through;opacity:0.6;', 'kind', 'key', 'Online\x20Now', 'list-row', 'content', 'tits', 'dm_', 'vagina', '2643DsTZaE', 'porn', 'updateOwnerBadge\x20called', 'Change\x20Username', 'terrorist', 'beforeunload', 'isOwner', 'adminKeyInput', 'none', 'dmTarget', 'damn', 'You\x20have\x20been\x20muted\x20for\x2010\x20minutes\x20due\x20to\x20spam', 'No\x20conversations\x20yet.\x20Start\x20a\x20DM\x20or\x20create\x20a\x20group!', 'textContent', '#4CAF50', 'Send\x20error:', 'messages', 'DM:\x20', 'getFullYear', '772161335544', '0.5', 'shift', 'startDmBtn', '\x5cb\x5cw*', 'forEach', 'Your\x20name', 'modalCancel', 'public', 'font-size:0.85rem;color:var(--text-muted);margin-top:0.2rem;', 'font-size:0.7rem;', 'Maximum\x2020\x20characters', 'info', 'groupTargets', 'fag', 'pointer', 'body', 'banned', 'animation', 'slut', 'Failed\x20to\x20update\x20ban\x20status', 'display:flex;gap:0.5rem;', '20eUKGMd', '\x20me', 'uid', '.user-row[data-uid=\x22', 'Access\x20denied.\x20Admin\x20key\x20required.', 'modalOverlay', 'masturbate', 'success', 'Start\x20a\x20Direct\x20Message', 'publicBtn', 'sex', 'usersPanel', 'Yesterday,\x20', '0000', 'user-name', 'Admin\x20access\x20key', 'Username\x20can\x20only\x20contain\x20lowercase\x20letters,\x20numbers,\x20spaces,\x20and\x20basic\x20punctuation\x20(.\x20_\x20-)', 'avatar', 'retard', 'appendChild', 'max-height:500px;overflow-y:auto;', 'msgCount', 'font-size:0.75rem;color:var(--text-muted);', 'Group:\x20', '228417vccRgA', 'users', 'Total\x20Users', 'getElementById', 'groups', 'from', 'cock', 'Mute\x20error:', 'You\x20are\x20banned\x20from\x20this\x20chat,\x20get\x20a\x20life', 'keydown', 'createTextNode', 'font-weight:500;', 'replace', 'ðŸ’¡\x20Tip:\x20Ban\x20removes\x20access,\x20Mute\x20prevents\x20messaging\x20for\x2010\x20minutes', 'death', 'getAttribute', 'adminPanelBtn', 'Banned\x20Users', 'DM\x20create\x20error:', 'doc', 'createElement', 'Enter\x20the\x20admin\x20key\x20to\x20unlock\x20special\x20privileges', 'â™›\x20JRDN', 'DM\x20load\x20error:', 'inline-block', 'warning', 'User\x20status\x20check\x20error:', 'font-size:1.5rem;font-weight:bold;color:', 'disabled', 'includes', '1596PniNkT', 'Loaded\x20existing\x20profile:', 'block', 'querySelectorAll', 'bastard', 'mutedUntil', 'adminKeys', 'AIzaSyDEqDJCDKYDBpN30t2SijjoECE_9bMGHDM', 'maxlength', 'dms', 'Maximum\x2014\x20characters.\x20Lowercase\x20letters,\x20numbers,\x20and\x20basic\x20punctuation\x20only.', 'Pick\x20exactly\x20one\x20person.', 'font-weight:bold;color:var(--text-muted);min-width:30px;', 'orgasm', 'filter', 'G-3CNJSYWDVG', 'padding:1rem;color:var(--text-muted);font-size:0.9rem;', 'newGroupName', 'var(--text-muted)', 'stopPropagation', 'Admin\x20access\x20granted!', 'marginTop', 'memberUids', 'Ban', '1351tvJgmj', 'loaded', '\x20has\x20been\x20', 'checkbox']; _0x3c8b = function () { return _0xa44980; }; return _0x3c8b(); } function roomPathForCurrent() { const _0xe10ee9 = _0x28df0b; if (current['type'] === _0xe10ee9(0x1ba)) return [_0xe10ee9(0x290), _0xe10ee9(0x1ba), _0xe10ee9(0x1af)]; if (current[_0xe10ee9(0x148)] === 'dm') return [_0xe10ee9(0x207), current['id'], _0xe10ee9(0x1af)]; if (current[_0xe10ee9(0x148)] === _0xe10ee9(0x230)) return [_0xe10ee9(0x1e4), current['id'], 'messages']; return ['rooms', 'public', _0xe10ee9(0x1af)]; } function renderMessage(_0x5a6e49) { const _0x37778b = _0x28df0b, _0x3b27dd = document[_0x37778b(0x1f4)](_0x37778b(0x29a)); _0x3b27dd[_0x37778b(0x286)] = _0x37778b(0x28b) + (_0x5a6e49[_0x37778b(0x1ca)] === me[_0x37778b(0x1ca)] ? _0x37778b(0x1c9) : ''); const _0x91fb7c = document['createElement'](_0x37778b(0x29a)); _0x91fb7c[_0x37778b(0x286)] = _0x37778b(0x1d9), _0x91fb7c[_0x37778b(0x1ac)] = avatarLetter(_0x5a6e49[_0x37778b(0x170)]); const _0x55c9cc = document[_0x37778b(0x1f4)](_0x37778b(0x29a)); _0x55c9cc[_0x37778b(0x286)] = _0x37778b(0x19b); const _0x542ab0 = document[_0x37778b(0x1f4)](_0x37778b(0x29a)); _0x542ab0[_0x37778b(0x286)] = 'name'; const _0x233864 = formatTimestamp(_0x5a6e49[_0x37778b(0x27c)]), _0x453f49 = sanitizeInput(_0x5a6e49[_0x37778b(0x170)] || _0x37778b(0x153), 0x14), _0x4a8ac6 = sanitizeInput(_0x5a6e49[_0x37778b(0x26c)] || _0x37778b(0x1d5), 0xa); _0x542ab0[_0x37778b(0x1ac)] = safeUsername(_0x453f49, _0x4a8ac6) + _0x37778b(0x233) + _0x233864; const _0x59b167 = document[_0x37778b(0x1f4)]('div'), _0x1e7783 = filterSwearing(sanitizeInput(_0x5a6e49[_0x37778b(0x252)] || '', 0x77)); return _0x59b167[_0x37778b(0x1ac)] = _0x1e7783, _0x55c9cc[_0x37778b(0x1db)](_0x542ab0), _0x55c9cc['appendChild'](_0x59b167), _0x3b27dd['appendChild'](_0x91fb7c), _0x3b27dd['appendChild'](_0x55c9cc), _0x3b27dd; } function setActiveRoomButton(_0x45f0d9) { const _0x44c9fc = _0x28df0b; document[_0x44c9fc(0x201)]('.room-btn')[_0x44c9fc(0x1b7)](_0x3085ab => _0x3085ab['classList']['remove'](_0x44c9fc(0x21e))); if (validateId(_0x45f0d9)) { const _0x1f1229 = document[_0x44c9fc(0x1e3)](_0x44c9fc(0x163) + _0x45f0d9); if (_0x1f1229) _0x1f1229[_0x44c9fc(0x23a)][_0x44c9fc(0x18e)](_0x44c9fc(0x21e)); } if (_0x45f0d9 === 'public') publicBtn[_0x44c9fc(0x23a)]['add'](_0x44c9fc(0x21e)); } async function loadUserProfile() { const _0xa1afdc = _0x28df0b; if (!me[_0xa1afdc(0x1ca)]) return ![]; try { const _0x3d6cc6 = await getDoc(doc(db, _0xa1afdc(0x1e1), me[_0xa1afdc(0x1ca)])); if (_0x3d6cc6[_0xa1afdc(0x222)]()) { const _0x2fbdba = _0x3d6cc6[_0xa1afdc(0x279)](); return me[_0xa1afdc(0x170)] = _0x2fbdba[_0xa1afdc(0x170)], me[_0xa1afdc(0x26c)] = _0x2fbdba[_0xa1afdc(0x26c)], me[_0xa1afdc(0x1d9)] = avatarLetter(me[_0xa1afdc(0x170)]), sessionStorage[_0xa1afdc(0x192)](_0xa1afdc(0x16a), me[_0xa1afdc(0x170)]), sessionStorage['setItem'](_0xa1afdc(0x177), me['tag']), console['log'](_0xa1afdc(0x1ff), me[_0xa1afdc(0x170)], me['tag']), !![]; } return ![]; } catch (_0x3f7ae7) { return console[_0xa1afdc(0x242)](_0xa1afdc(0x146), _0x3f7ae7), ![]; } } onAuthStateChanged(auth, async _0xf20f64 => { const _0x190596 = _0x28df0b; if (!_0xf20f64) return; me['uid'] = _0xf20f64[_0x190596(0x1ca)], await checkAdminStatus(), adminCheckComplete = !![]; const _0x49d3c3 = await loadUserProfile(); !_0x49d3c3 && !me[_0x190596(0x170)] ? showUsernameModal(_0x190596(0x150)) : (me[_0x190596(0x1d9)] = avatarLetter(me[_0x190596(0x170)]), await upsertUserProfile(), updateAdminUI(), startListeners(), addEmojiPicker(), requestNotificationPermission()); }), signInAnonymously(auth)[_0x28df0b(0x172)](console[_0x28df0b(0x242)]); function showUsernameModal(_0x36ae78) { createSafeModal(_0x36ae78, () => { const _0x531360 = _0x51d0, _0x19facf = document[_0x531360(0x1f4)](_0x531360(0x29a)), _0x51d55e = document[_0x531360(0x1f4)](_0x531360(0x21b)); _0x51d55e['id'] = 'usernameInput', _0x51d55e['className'] = _0x531360(0x21b), _0x51d55e['placeholder'] = _0x531360(0x1b8), _0x51d55e[_0x531360(0x223)] = 0xe; const _0x147196 = createTextElement(_0x531360(0x29a), _0x531360(0x208)); return _0x147196['style'][_0x531360(0x27f)] = _0x531360(0x141), _0x19facf[_0x531360(0x1db)](_0x51d55e), _0x19facf[_0x531360(0x1db)](_0x147196), _0x36ae78 === _0x531360(0x150) && (modalCancel['style'][_0x531360(0x268)] = _0x531360(0x1a7)), _0x19facf; }, async () => { const _0x249baa = _0x51d0, _0x38b9fe = document[_0x249baa(0x1e3)](_0x249baa(0x26d))[_0x249baa(0x15f)], _0x1aa00b = /^[a-z0-9\s._-]+$/; if (!_0x1aa00b[_0x249baa(0x299)](_0x38b9fe[_0x249baa(0x25b)]())) { alert(_0x249baa(0x1d8)); return; } const _0xc82ee0 = sanitizeInput(_0x38b9fe, 0x14); if (!_0xc82ee0) return; me[_0x249baa(0x170)] = _0xc82ee0, me['tag'] = randomTag(), me['avatar'] = avatarLetter(_0xc82ee0), sessionStorage[_0x249baa(0x192)](_0x249baa(0x16a), me['name']), sessionStorage['setItem'](_0x249baa(0x177), me[_0x249baa(0x26c)]), await upsertUserProfile(), modalCancel[_0x249baa(0x194)][_0x249baa(0x268)] = '', closeModal(), updateAdminUI(), startListeners(), addEmojiPicker(), requestNotificationPermission(); }); } changeNameBtn[_0x28df0b(0x176)] = () => showUsernameModal(_0x28df0b(0x1a2)); async function upsertUserProfile() { const _0x4e31d9 = _0x28df0b; if (!me['uid']) return; try { const _0x5c129c = doc(db, _0x4e31d9(0x1e1), me[_0x4e31d9(0x1ca)]); await setDoc(_0x5c129c, { 'uid': me[_0x4e31d9(0x1ca)], 'name': sanitizeInput(me[_0x4e31d9(0x170)], 0x14), 'tag': sanitizeInput(me['tag'], 0xa), 'avatar': avatarLetter(me[_0x4e31d9(0x170)]), 'status': _0x4e31d9(0x267), 'lastSeen': serverTimestamp() }, { 'merge': !![] }); } catch (_0x55bdfb) { console['error'](_0x4e31d9(0x152), _0x55bdfb); } window[_0x4e31d9(0x269)](_0x4e31d9(0x1a4), async () => { const _0x3b1825 = _0x4e31d9; try { const _0xf47ae5 = doc(db, 'users', me[_0x3b1825(0x1ca)]); await updateDoc(_0xf47ae5, { 'status': 'offline', 'lastSeen': serverTimestamp() }); } catch (_0x26a4a6) { console[_0x3b1825(0x242)](_0x3b1825(0x251), _0x26a4a6); } }); } function showLoadingScreen() { const _0x36e7e4 = _0x28df0b; if (roomCache[current['id']]?.[_0x36e7e4(0x217)]) return; messagesEl['innerHTML'] = _0x36e7e4(0x171); } function openRoom(_0x218476, _0x312b9b, _0x351b1c) { const _0x219cee = _0x28df0b, _0x518ace = sanitizeInput(_0x218476, 0xa), _0xf93151 = sanitizeInput(_0x312b9b, 0x32), _0x57efbd = sanitizeInput(_0x351b1c, 0x64); current = { 'type': _0x518ace, 'id': _0xf93151, 'title': _0x57efbd }, chatTitle['textContent'] = _0x57efbd; const _0x22d27c = document[_0x219cee(0x1e3)](_0x219cee(0x154)); if (_0x22d27c) _0x22d27c[_0x219cee(0x194)]['display'] = _0x518ace === _0x219cee(0x230) ? _0x219cee(0x1f8) : _0x219cee(0x1a7); const _0x40ce2c = _0xf93151; roomCache[_0x40ce2c]?.['loaded'] && roomCache[_0x40ce2c][_0x219cee(0x28e)] ? (messagesEl[_0x219cee(0x158)] = '', messagesEl[_0x219cee(0x1db)](roomCache[_0x40ce2c]['fragment']['cloneNode'](!![])), messagesEl[_0x219cee(0x283)] = messagesEl[_0x219cee(0x26b)], !activeListeners[_0x40ce2c] && setupRoomListener(_0x518ace, _0xf93151, _0x40ce2c, ![])) : (showLoadingScreen(), setupRoomListener(_0x518ace, _0xf93151, _0x40ce2c, !![])), setActiveRoomButton(_0xf93151); } function setupRoomListener(_0x3331cf, _0x11e6dd, _0x2f1d97, _0x2306f2) { const _0x3e5c1b = _0x28df0b; activeListeners[_0x11e6dd] && activeListeners[_0x11e6dd](); const [_0x5e4f22, _0x8f5d3b, _0x4b5d19] = _0x3331cf === 'public' ? [_0x3e5c1b(0x290), 'public', _0x3e5c1b(0x1af)] : _0x3331cf === 'dm' ? [_0x3e5c1b(0x207), _0x11e6dd, 'messages'] : [_0x3e5c1b(0x1e4), _0x11e6dd, _0x3e5c1b(0x1af)], _0x36099a = query(collection(db, _0x5e4f22, _0x8f5d3b, _0x4b5d19), orderBy(_0x3e5c1b(0x27c))), _0x4534a2 = { 'value': -0x1 }; activeListeners[_0x11e6dd] = onSnapshot(_0x36099a, _0x31f92a => { const _0xb990d3 = _0x3e5c1b, _0x3991ce = current['id'] === _0x11e6dd; if (_0x2306f2) { const _0x1af66d = document['createDocumentFragment'](), _0x4f856d = [], _0x273096 = 0x64, _0x26a9d1 = _0x31f92a[_0xb990d3(0x273)]; for (let _0x4e4f3e = 0x0; _0x4e4f3e < _0x26a9d1['length']; _0x4e4f3e += _0x273096) { const _0x448e1b = _0x26a9d1[_0xb990d3(0x16e)](_0x4e4f3e, _0x4e4f3e + _0x273096); _0x448e1b[_0xb990d3(0x1b7)](_0x13ab90 => { const _0x175c7e = _0xb990d3, _0x308fdd = renderMessage(_0x13ab90[_0x175c7e(0x279)]()); _0x1af66d[_0x175c7e(0x1db)](_0x308fdd), _0x4f856d['push'](_0x308fdd['cloneNode'](!![])); }); } roomCache[_0x2f1d97] = { 'messages': _0x4f856d, 'loaded': !![], 'fragment': _0x1af66d[_0xb990d3(0x23e)](!![]) }, _0x3991ce && (messagesEl[_0xb990d3(0x158)] = '', messagesEl[_0xb990d3(0x1db)](_0x1af66d), messagesEl['scrollTop'] = messagesEl[_0xb990d3(0x26b)]), _0x4534a2['value'] = _0x31f92a[_0xb990d3(0x273)]['length'] - 0x1, _0x2306f2 = ![]; } else for (const _0x5aa2c5 of _0x31f92a['docChanges']()) { if (_0x5aa2c5[_0xb990d3(0x148)] === _0xb990d3(0x14b) && _0x5aa2c5[_0xb990d3(0x14d)] > _0x4534a2[_0xb990d3(0x15f)]) { const _0x5d3166 = _0x5aa2c5[_0xb990d3(0x1f3)][_0xb990d3(0x279)](), _0x1542c0 = renderMessage(_0x5d3166); roomCache[_0x2f1d97] && (roomCache[_0x2f1d97]['messages']['push'](_0x1542c0[_0xb990d3(0x23e)](!![])), roomCache[_0x2f1d97][_0xb990d3(0x28e)] && roomCache[_0x2f1d97]['fragment'][_0xb990d3(0x1db)](_0x1542c0[_0xb990d3(0x23e)](!![]))), _0x3991ce && (messagesEl[_0xb990d3(0x1db)](_0x1542c0), showMessageNotification(_0x5d3166, current[_0xb990d3(0x148)]), messagesEl[_0xb990d3(0x283)] = messagesEl[_0xb990d3(0x26b)]), _0x4534a2[_0xb990d3(0x15f)] = _0x5aa2c5[_0xb990d3(0x14d)]; } } }, _0x3b8d8d => { const _0x159a9e = _0x3e5c1b; console[_0x159a9e(0x242)]('Messages\x20listener\x20error:', _0x3b8d8d), isActiveRoom && (messagesEl[_0x159a9e(0x158)] = '<div\x20style=\x22text-align:center;padding:2rem;color:var(--text-muted);\x22>Failed\x20to\x20load\x20messages</div>', showStatusMessage(_0x159a9e(0x229), _0x159a9e(0x242))); }); } function startListeners() { const _0x2955f9 = _0x28df0b; if (!me[_0x2955f9(0x1ca)]) { setTimeout(() => startListeners(), 0x64); return; } if (unsubUsers) unsubUsers(); unsubUsers = onSnapshot(query(collection(db, _0x2955f9(0x1e1)), orderBy(_0x2955f9(0x170))), _0x3dc26e => { usersList['innerHTML'] = '', _0x3dc26e['forEach'](_0x18e047 => { const _0xbd3164 = _0x51d0, _0x5530bb = _0x18e047[_0xbd3164(0x279)](); if (!_0x5530bb[_0xbd3164(0x170)]) return; const _0x484610 = { 'uid': _0x5530bb['uid'], 'name': sanitizeInput(_0x5530bb[_0xbd3164(0x170)], 0x14), 'tag': sanitizeInput(_0x5530bb[_0xbd3164(0x26c)], 0xa), 'status': sanitizeInput(_0x5530bb['status'] || _0xbd3164(0x18a), 0x14) }; _0x484610['uid'] === me[_0xbd3164(0x1ca)] && (_0x484610[_0xbd3164(0x170)] = me[_0xbd3164(0x170)], _0x484610[_0xbd3164(0x26c)] = me[_0xbd3164(0x26c)]); const _0x2a5d54 = document[_0xbd3164(0x1f4)]('div'); _0x2a5d54['className'] = 'user-row', safeSetAttribute(_0x2a5d54, 'data-uid', _0x484610['uid']); const _0x32f685 = createTextElement('div', avatarLetter(_0x484610['name']), _0xbd3164(0x1d9)), _0x5c9de5 = document[_0xbd3164(0x1f4)](_0xbd3164(0x29a)), _0x3e64cb = createTextElement(_0xbd3164(0x29a), '' + safeUsername(_0x484610['name'], _0x484610[_0xbd3164(0x26c)]) + (_0x484610['uid'] === me['uid'] ? _0xbd3164(0x161) : ''), _0xbd3164(0x1d6)), _0x1bb447 = createTextElement('div', _0x484610[_0xbd3164(0x183)], _0xbd3164(0x255)); _0x5c9de5[_0xbd3164(0x1db)](_0x3e64cb), _0x5c9de5['appendChild'](_0x1bb447), _0x2a5d54[_0xbd3164(0x1db)](_0x32f685), _0x2a5d54[_0xbd3164(0x1db)](_0x5c9de5), _0x2a5d54[_0xbd3164(0x176)] = () => { const _0x571536 = _0xbd3164; _0x484610[_0x571536(0x1ca)] !== me[_0x571536(0x1ca)] && (createOrOpenDM(_0x484610[_0x571536(0x1ca)], _0x484610['name'], _0x484610['tag']), usersPanel['classList'][_0x571536(0x17b)](_0x571536(0x14a))); }, usersList[_0xbd3164(0x1db)](_0x2a5d54); }); }, _0x269c6f => { const _0x2387fa = _0x2955f9; console[_0x2387fa(0x242)]('Users\x20listener\x20error:', _0x269c6f), showStatusMessage('Failed\x20to\x20load\x20users', _0x2387fa(0x242)); }); if (unsubMyRooms) unsubMyRooms(); const _0xd485d8 = { 'dms': [], 'groups': [] }, _0x5554e2 = () => { const _0xafa563 = _0x2955f9; myChats[_0xafa563(0x158)] = ''; const _0x390a09 = _0xd485d8[_0xafa563(0x207)][_0xafa563(0x26a)]((_0x12aad2, _0x3f42f1) => (_0x3f42f1[_0xafa563(0x240)]?.[_0xafa563(0x181)] || 0x0) - (_0x12aad2[_0xafa563(0x240)]?.[_0xafa563(0x181)] || 0x0)), _0x3870ac = _0xd485d8[_0xafa563(0x1e4)][_0xafa563(0x26a)]((_0x119f41, _0x5aff21) => (_0x5aff21[_0xafa563(0x240)]?.[_0xafa563(0x181)] || 0x0) - (_0x119f41[_0xafa563(0x240)]?.['seconds'] || 0x0)); _0x390a09['length'] > 0x0 && _0x390a09[_0xafa563(0x1b7)](_0x201850 => { const _0x49f1b7 = _0xafa563, _0x29caf0 = document[_0x49f1b7(0x1f4)](_0x49f1b7(0x247)); _0x29caf0[_0x49f1b7(0x286)] = _0x49f1b7(0x28c); if (validateId(_0x201850[_0x49f1b7(0x198)])) _0x29caf0['id'] = 'roombtn_' + _0x201850[_0x49f1b7(0x198)]; _0x29caf0[_0x49f1b7(0x1ac)] = sanitizeInput(_0x201850[_0x49f1b7(0x22c)][_0x49f1b7(0x1ec)](_0x49f1b7(0x1b0), ''), 0x32), _0x29caf0[_0x49f1b7(0x176)] = () => openRoom(_0x201850[_0x49f1b7(0x197)], _0x201850['id'], _0x201850[_0x49f1b7(0x22c)]), myChats[_0x49f1b7(0x1db)](_0x29caf0); }); if (_0x3870ac['length'] > 0x0) { if (_0x390a09[_0xafa563(0x282)] > 0x0) { const _0x35eac6 = createTextElement(_0xafa563(0x29a), 'Groups', _0xafa563(0x226)); _0x35eac6['style'][_0xafa563(0x213)] = '1rem', myChats['appendChild'](_0x35eac6); } _0x3870ac[_0xafa563(0x1b7)](_0x200574 => { const _0x23cfc6 = _0xafa563, _0x5efa35 = document[_0x23cfc6(0x1f4)](_0x23cfc6(0x247)); _0x5efa35[_0x23cfc6(0x286)] = _0x23cfc6(0x28c); if (validateId(_0x200574[_0x23cfc6(0x198)])) _0x5efa35['id'] = _0x23cfc6(0x163) + _0x200574['key']; _0x5efa35[_0x23cfc6(0x1ac)] = sanitizeInput(_0x200574[_0x23cfc6(0x22c)][_0x23cfc6(0x1ec)](_0x23cfc6(0x1df), ''), 0x32), _0x5efa35[_0x23cfc6(0x176)] = () => openRoom(_0x200574[_0x23cfc6(0x197)], _0x200574['id'], _0x200574[_0x23cfc6(0x22c)]), myChats[_0x23cfc6(0x1db)](_0x5efa35); }); } if (_0x390a09[_0xafa563(0x282)] === 0x0 && _0x3870ac[_0xafa563(0x282)] === 0x0) { const _0x206843 = createTextElement(_0xafa563(0x29a), _0xafa563(0x1ab)); _0x206843['style'][_0xafa563(0x27f)] = _0xafa563(0x20e), myChats[_0xafa563(0x1db)](_0x206843); } setActiveRoomButton(current['id']); }, _0x2887bc = query(collection(db, _0x2955f9(0x207)), where(_0x2955f9(0x214), _0x2955f9(0x24d), me[_0x2955f9(0x1ca)])), _0x34d6f8 = onSnapshot(_0x2887bc, _0x8468ba => { const _0x432380 = _0x2955f9; _0xd485d8[_0x432380(0x207)] = _0x8468ba[_0x432380(0x273)][_0x432380(0x275)](_0x134901 => { const _0x51e84a = _0x432380, _0x3342a1 = _0x134901[_0x51e84a(0x279)](), _0x4eb7b5 = (_0x3342a1['memberUids'] || [])[_0x51e84a(0x22f)](_0xd33e8b => _0xd33e8b !== me[_0x51e84a(0x1ca)]), _0x46e733 = sanitizeInput(_0x3342a1['memberNames']?.[_0x4eb7b5] || _0x51e84a(0x153), 0x14), _0x99c4ff = sanitizeInput(_0x3342a1['memberTags']?.[_0x4eb7b5] || _0x51e84a(0x1d5), 0xa); return { 'kind': 'dm', 'id': _0x134901['id'], 'key': _0x134901['id'], 'label': 'DM:\x20' + safeUsername(_0x46e733, _0x99c4ff), 'updatedAt': _0x3342a1['updatedAt'] }; }), _0x5554e2(); }, _0x33be08 => { const _0xf040ed = _0x2955f9; console[_0xf040ed(0x242)]('DM\x20listener\x20error:', _0x33be08); }), _0x12deda = query(collection(db, 'groups'), where(_0x2955f9(0x214), _0x2955f9(0x24d), me[_0x2955f9(0x1ca)])), _0x3826d2 = onSnapshot(_0x12deda, _0x23e41a => { const _0x26b1de = _0x2955f9; _0xd485d8[_0x26b1de(0x1e4)] = _0x23e41a['docs']['map'](_0x454464 => { const _0x5b8901 = _0x26b1de, _0x512ca6 = _0x454464[_0x5b8901(0x279)](), _0x5b8f2d = sanitizeInput(_0x512ca6['name'] || 'Unnamed', 0x32); return { 'kind': _0x5b8901(0x230), 'id': _0x454464['id'], 'key': _0x454464['id'], 'label': _0x5b8901(0x1df) + _0x5b8f2d, 'updatedAt': _0x512ca6['updatedAt'] }; }), _0x5554e2(); }, _0x51883d => { const _0x1d589f = _0x2955f9; console[_0x1d589f(0x242)]('Group\x20listener\x20error:', _0x51883d); }); unsubMyRooms = () => { _0x34d6f8(), _0x3826d2(); }, openRoom(current[_0x2955f9(0x148)], current['id'], current['title']), current['id'] !== _0x2955f9(0x1ba) && setTimeout(() => { const _0x98b934 = _0x2955f9; setupRoomListener('public', 'public', _0x98b934(0x1ba), !![]); }, 0x1f4); } async function sendMessage() { const _0x350f3a = _0x28df0b, _0x411475 = sanitizeInput(messageInput['value'], 0x77); if (!_0x411475 || !me[_0x350f3a(0x1ca)] || !me[_0x350f3a(0x170)]) return; try { const _0x197cb2 = query(collection(db, _0x350f3a(0x1e1)), where('uid', '==', me[_0x350f3a(0x1ca)])), _0x5397ef = await getDocs(_0x197cb2); if (!_0x5397ef[_0x350f3a(0x22d)]) { const _0x4ef3c6 = _0x5397ef['docs'][0x0][_0x350f3a(0x279)](); if (_0x4ef3c6['banned']) { showStatusMessage(_0x350f3a(0x1e8), _0x350f3a(0x242)), messageInput[_0x350f3a(0x15f)] = ''; if (window[_0x350f3a(0x243)]) window[_0x350f3a(0x243)](); return; } if (_0x4ef3c6[_0x350f3a(0x203)] && _0x4ef3c6['mutedUntil'] > Date[_0x350f3a(0x264)]()) { const _0x4fe1f4 = Math[_0x350f3a(0x285)]((_0x4ef3c6[_0x350f3a(0x203)] - Date['now']()) / 0x3e8); showStatusMessage(_0x350f3a(0x180) + _0x4fe1f4 + _0x350f3a(0x24f), 'error'), messageInput[_0x350f3a(0x15f)] = ''; if (window[_0x350f3a(0x243)]) window[_0x350f3a(0x243)](); return; } } } catch (_0x251be9) { console['error'](_0x350f3a(0x1fa), _0x251be9); } if (!checkSpamProtection(_0x411475)) return; try { const [_0xd044e8, _0x5eeb92, _0x487b11] = roomPathForCurrent(), _0x3d1b94 = { 'uid': me[_0x350f3a(0x1ca)], 'name': sanitizeInput(me[_0x350f3a(0x170)], 0x14), 'tag': sanitizeInput(me[_0x350f3a(0x26c)], 0xa), 'text': _0x411475, 'timestamp': serverTimestamp() }; await addDoc(collection(db, _0xd044e8, _0x5eeb92, _0x487b11), _0x3d1b94); if (current['type'] === 'dm') await setDoc(doc(db, _0x350f3a(0x207), current['id']), { 'updatedAt': serverTimestamp() }, { 'merge': !![] })['catch'](console['error']); else { if (current[_0x350f3a(0x148)] === _0x350f3a(0x230)) await setDoc(doc(db, _0x350f3a(0x1e4), current['id']), { 'updatedAt': serverTimestamp() }, { 'merge': !![] })[_0x350f3a(0x172)](console['error']); } messageInput[_0x350f3a(0x15f)] = ''; if (window[_0x350f3a(0x243)]) window[_0x350f3a(0x243)](); } catch (_0x106447) { console['error'](_0x350f3a(0x1ae), _0x106447), showStatusMessage('Failed\x20to\x20send\x20message.\x20Try\x20again.', 'error'); } } sendBtn[_0x28df0b(0x176)] = sendMessage, messageInput[_0x28df0b(0x269)](_0x28df0b(0x1e9), _0x2baffd => { const _0x438abe = _0x28df0b; _0x2baffd['key'] === 'Enter' && !_0x2baffd[_0x438abe(0x284)] && (_0x2baffd[_0x438abe(0x28a)](), sendMessage()); }), publicBtn[_0x28df0b(0x176)] = () => openRoom(_0x28df0b(0x1ba), _0x28df0b(0x1ba), _0x28df0b(0x157)), toggleUsersBtn[_0x28df0b(0x176)] = () => usersPanel[_0x28df0b(0x23a)][_0x28df0b(0x23f)](_0x28df0b(0x14a)), startDmBtn[_0x28df0b(0x176)] = async () => { const _0x2464a4 = _0x28df0b; try { const _0x1b3c43 = await getDocs(query(collection(db, _0x2464a4(0x1e1)), orderBy(_0x2464a4(0x170)))); createSafeModal(_0x2464a4(0x1d0), () => { const _0x20c316 = _0x2464a4, _0x2be455 = document[_0x20c316(0x1f4)]('div'), _0x1b513c = document[_0x20c316(0x1f4)](_0x20c316(0x29a)); _0x1b513c[_0x20c316(0x286)] = _0x20c316(0x270); let _0x25bdd2 = ![]; _0x1b3c43['forEach'](_0x1a45c8 => { const _0x232701 = _0x20c316, _0x1f6ddf = _0x1a45c8['data'](); if (_0x1f6ddf[_0x232701(0x1ca)] === me[_0x232701(0x1ca)] || !_0x1f6ddf[_0x232701(0x170)]) return; _0x25bdd2 = !![]; const _0x3541c2 = document['createElement'](_0x232701(0x22c)); _0x3541c2['className'] = _0x232701(0x19a); const _0x36957e = document['createElement'](_0x232701(0x21b)); _0x36957e[_0x232701(0x148)] = _0x232701(0x260), _0x36957e[_0x232701(0x170)] = _0x232701(0x1a8), _0x36957e[_0x232701(0x15f)] = _0x1f6ddf['uid'], safeSetAttribute(_0x36957e, _0x232701(0x29b), sanitizeInput(_0x1f6ddf[_0x232701(0x170)], 0x14)), safeSetAttribute(_0x36957e, _0x232701(0x294), sanitizeInput(_0x1f6ddf[_0x232701(0x26c)], 0xa)); const _0x241f21 = createTextElement(_0x232701(0x29a), avatarLetter(_0x1f6ddf[_0x232701(0x170)]), _0x232701(0x1d9)), _0x385bce = createTextElement(_0x232701(0x29a), safeUsername(_0x1f6ddf[_0x232701(0x170)], _0x1f6ddf[_0x232701(0x26c)])); _0x3541c2[_0x232701(0x1db)](_0x36957e), _0x3541c2[_0x232701(0x1db)](_0x241f21), _0x3541c2[_0x232701(0x1db)](_0x385bce), _0x1b513c[_0x232701(0x1db)](_0x3541c2); }); if (_0x25bdd2) { const _0x50ea10 = createTextElement(_0x20c316(0x29a), _0x20c316(0x209), _0x20c316(0x261)); _0x2be455[_0x20c316(0x1db)](_0x1b513c), _0x2be455[_0x20c316(0x1db)](_0x50ea10); } else { const _0x13de72 = createTextElement(_0x20c316(0x29a), _0x20c316(0x145), _0x20c316(0x261)); _0x2be455[_0x20c316(0x1db)](_0x13de72); } return _0x2be455; }, async () => { const _0x3450fc = _0x2464a4, _0x17ebdf = modalBody[_0x3450fc(0x151)](_0x3450fc(0x15c)); if (!_0x17ebdf) return; const _0xe97aa9 = _0x17ebdf[_0x3450fc(0x15f)], _0x499870 = _0x17ebdf[_0x3450fc(0x1ef)]('data-name'), _0x2a706e = _0x17ebdf[_0x3450fc(0x1ef)](_0x3450fc(0x294)); await createOrOpenDM(_0xe97aa9, _0x499870, _0x2a706e), closeModal(); }); } catch (_0x441d14) { console[_0x2464a4(0x242)](_0x2464a4(0x1f7), _0x441d14); } }; async function createOrOpenDM(_0x1cf248, _0x36e206, _0x3fa9ec) { const _0x5b6a7b = _0x28df0b; if (_0x1cf248 === me[_0x5b6a7b(0x1ca)]) return; try { const _0x103931 = sanitizeInput(_0x1cf248, 0x32), _0x51f69c = sanitizeInput(_0x36e206, 0x14), _0x199332 = sanitizeInput(_0x3fa9ec, 0xa), _0x4ba4bd = [me['uid'], _0x103931][_0x5b6a7b(0x26a)](), _0x566ea1 = _0x5b6a7b(0x19d) + _0x4ba4bd[0x0] + '_' + _0x4ba4bd[0x1], _0x1b2e39 = doc(db, 'dms', _0x566ea1); await setDoc(_0x1b2e39, { 'id': _0x566ea1, 'kind': 'dm', 'memberUids': _0x4ba4bd, 'memberNames': { [me[_0x5b6a7b(0x1ca)]]: sanitizeInput(me[_0x5b6a7b(0x170)], 0x14), [_0x103931]: _0x51f69c }, 'memberTags': { [me[_0x5b6a7b(0x1ca)]]: sanitizeInput(me[_0x5b6a7b(0x26c)], 0xa), [_0x103931]: _0x199332 }, 'updatedAt': serverTimestamp() }, { 'merge': !![] }), openRoom('dm', _0x566ea1, _0x5b6a7b(0x1b0) + safeUsername(_0x51f69c, _0x199332)); } catch (_0x39ae3b) { console[_0x5b6a7b(0x242)](_0x5b6a7b(0x1f2), _0x39ae3b); } } createGroupBtn[_0x28df0b(0x176)] = async () => { const _0x44e30a = _0x28df0b; try { const _0x2c0f90 = await getDocs(query(collection(db, _0x44e30a(0x1e1)), orderBy(_0x44e30a(0x170)))); createSafeModal('Create\x20Group\x20(up\x20to\x2010)', () => { const _0x4e69fa = _0x44e30a, _0x2a1c1 = document[_0x4e69fa(0x1f4)]('div'), _0x196e1d = document['createElement'](_0x4e69fa(0x21b)); _0x196e1d['id'] = 'groupName', _0x196e1d[_0x4e69fa(0x286)] = _0x4e69fa(0x21b), _0x196e1d[_0x4e69fa(0x15e)] = _0x4e69fa(0x17f), _0x196e1d[_0x4e69fa(0x223)] = 0x14; const _0x36c388 = createTextElement(_0x4e69fa(0x29a), _0x4e69fa(0x1bd)); _0x36c388[_0x4e69fa(0x194)][_0x4e69fa(0x27f)] = 'font-size:12px;color:var(--text-muted);margin-top:5px;'; const _0x287338 = document['createElement'](_0x4e69fa(0x29a)); _0x287338['className'] = _0x4e69fa(0x270), _0x287338[_0x4e69fa(0x194)]['marginTop'] = '0.6rem'; let _0x42c946 = ![]; _0x2c0f90['forEach'](_0x49d716 => { const _0x1bd7d2 = _0x4e69fa, _0x2d10f9 = _0x49d716[_0x1bd7d2(0x279)](); if (_0x2d10f9[_0x1bd7d2(0x1ca)] === me[_0x1bd7d2(0x1ca)] || !_0x2d10f9[_0x1bd7d2(0x170)]) return; _0x42c946 = !![]; const _0x281c7b = document[_0x1bd7d2(0x1f4)]('label'); _0x281c7b['className'] = 'list-row'; const _0x2f9e20 = document[_0x1bd7d2(0x1f4)](_0x1bd7d2(0x21b)); _0x2f9e20[_0x1bd7d2(0x148)] = _0x1bd7d2(0x219), _0x2f9e20[_0x1bd7d2(0x170)] = _0x1bd7d2(0x1bf), _0x2f9e20['value'] = _0x2d10f9[_0x1bd7d2(0x1ca)]; const _0x168f6b = createTextElement('div', avatarLetter(_0x2d10f9['name']), _0x1bd7d2(0x1d9)), _0x44252a = createTextElement(_0x1bd7d2(0x29a), safeUsername(_0x2d10f9['name'], _0x2d10f9[_0x1bd7d2(0x26c)])); _0x281c7b[_0x1bd7d2(0x1db)](_0x2f9e20), _0x281c7b[_0x1bd7d2(0x1db)](_0x168f6b), _0x281c7b[_0x1bd7d2(0x1db)](_0x44252a), _0x287338['appendChild'](_0x281c7b); }), _0x2a1c1['appendChild'](_0x196e1d), _0x2a1c1[_0x4e69fa(0x1db)](_0x36c388); if (_0x42c946) _0x2a1c1[_0x4e69fa(0x1db)](_0x287338); else { const _0x3a1100 = createTextElement(_0x4e69fa(0x29a), _0x4e69fa(0x195), _0x4e69fa(0x261)); _0x3a1100[_0x4e69fa(0x194)]['marginTop'] = '0.6rem', _0x2a1c1[_0x4e69fa(0x1db)](_0x3a1100); } return _0x2a1c1; }, async () => { const _0xfad556 = _0x44e30a, _0x41327b = sanitizeInput(document[_0xfad556(0x1e3)](_0xfad556(0x185))[_0xfad556(0x15f)], 0x14); if (!_0x41327b) return; const _0x33c21b = Array[_0xfad556(0x1e5)](modalBody[_0xfad556(0x201)]('input[name=\x22groupTargets\x22]:checked'))[_0xfad556(0x275)](_0x1dcb51 => sanitizeInput(_0x1dcb51[_0xfad556(0x15f)], 0x32)), _0x1ded87 = Array[_0xfad556(0x1e5)](new Set([me[_0xfad556(0x1ca)], ..._0x33c21b]))['slice'](0x0, 0xa), _0x1b6b8f = _0xfad556(0x249) + Date[_0xfad556(0x264)]()['toString'](0x24) + '_' + Math[_0xfad556(0x142)]()['toString'](0x24)[_0xfad556(0x16e)](0x2, 0x6); await setDoc(doc(db, _0xfad556(0x1e4), _0x1b6b8f), { 'id': _0x1b6b8f, 'name': _0x41327b, 'kind': _0xfad556(0x230), 'memberUids': _0x1ded87, 'updatedAt': serverTimestamp() }, { 'merge': !![] }), closeModal(), openRoom(_0xfad556(0x230), _0x1b6b8f, 'Group:\x20' + _0x41327b); }); } catch (_0x402ad8) { console[_0x44e30a(0x242)](_0x44e30a(0x21c), _0x402ad8); } }, renameGroupBtn[_0x28df0b(0x176)] = async () => { const _0x173b18 = _0x28df0b; if (current['type'] !== _0x173b18(0x230)) return; try { const _0x806e47 = doc(db, _0x173b18(0x1e4), current['id']), _0x225201 = sanitizeInput(current['title'][_0x173b18(0x1ec)](_0x173b18(0x1df), ''), 0x14); createSafeModal(_0x173b18(0x254), () => { const _0x16c6ff = _0x173b18, _0x547a30 = document[_0x16c6ff(0x1f4)](_0x16c6ff(0x29a)), _0x3e17ee = document[_0x16c6ff(0x1f4)](_0x16c6ff(0x21b)); _0x3e17ee['id'] = _0x16c6ff(0x20f), _0x3e17ee['className'] = 'input', _0x3e17ee['placeholder'] = _0x16c6ff(0x167), _0x3e17ee['value'] = _0x225201, _0x3e17ee[_0x16c6ff(0x223)] = 0x14; const _0x35d0d4 = createTextElement(_0x16c6ff(0x29a), 'Maximum\x2020\x20characters'); return _0x35d0d4[_0x16c6ff(0x194)][_0x16c6ff(0x27f)] = _0x16c6ff(0x141), _0x547a30['appendChild'](_0x3e17ee), _0x547a30[_0x16c6ff(0x1db)](_0x35d0d4), _0x547a30; }, async () => { const _0x3b690f = _0x173b18, _0xb2df35 = sanitizeInput(document[_0x3b690f(0x1e3)](_0x3b690f(0x20f))[_0x3b690f(0x15f)], 0x14); if (!_0xb2df35) return; await updateDoc(_0x806e47, { 'name': _0xb2df35, 'updatedAt': serverTimestamp() }), current[_0x3b690f(0x18b)] = _0x3b690f(0x1df) + _0xb2df35, chatTitle['textContent'] = current[_0x3b690f(0x18b)]; const _0x1d3f34 = document[_0x3b690f(0x1e3)](_0x3b690f(0x163) + current['id']); if (_0x1d3f34) _0x1d3f34[_0x3b690f(0x1ac)] = _0xb2df35; closeModal(); }); } catch (_0x4ce8e6) { console[_0x173b18(0x242)](_0x173b18(0x25e), _0x4ce8e6); } }, adminPanelBtn[_0x28df0b(0x176)] = async () => { const _0x1663d9 = _0x28df0b; if (!isAdmin || !adminCheckComplete) { showStatusMessage(_0x1663d9(0x1cc), _0x1663d9(0x242)); return; } try { const _0x4bd3e6 = await getDocs(query(collection(db, 'users'), orderBy('name'))), _0x2adbb8 = await getDocs(collection(db, _0x1663d9(0x1e4))), _0x565048 = await getDocs(collection(db, _0x1663d9(0x207))), _0xccd026 = {}, _0x3b6b76 = [], _0xcca22f = [], _0x56784e = []; for (const _0x4c4907 of _0x4bd3e6[_0x1663d9(0x273)]) { const _0x40c497 = _0x4c4907[_0x1663d9(0x279)](); _0xccd026[_0x40c497[_0x1663d9(0x1ca)]] = 0x0; if (_0x40c497[_0x1663d9(0x183)] === 'online') _0x3b6b76['push'](_0x40c497); if (_0x40c497[_0x1663d9(0x1c3)]) _0xcca22f[_0x1663d9(0x162)](_0x40c497); if (_0x40c497[_0x1663d9(0x203)] && _0x40c497[_0x1663d9(0x203)] > Date[_0x1663d9(0x264)]()) _0x56784e[_0x1663d9(0x162)](_0x40c497); } const _0x835eb8 = await getDocs(collection(db, _0x1663d9(0x290), _0x1663d9(0x1ba), _0x1663d9(0x1af))); _0x835eb8[_0x1663d9(0x1b7)](_0x18acc0 => { const _0x71b473 = _0x1663d9, _0x3c6560 = _0x18acc0[_0x71b473(0x279)](); if (_0xccd026[_0x3c6560[_0x71b473(0x1ca)]] !== undefined) _0xccd026[_0x3c6560[_0x71b473(0x1ca)]]++; }), createSafeModal('Admin\x20Panel', () => { const _0xaf06db = _0x1663d9, _0x439712 = document['createElement']('div'); _0x439712[_0xaf06db(0x194)][_0xaf06db(0x27f)] = _0xaf06db(0x1dc); const _0x59eea1 = createTextElement('h3', _0xaf06db(0x23d)); _0x59eea1[_0xaf06db(0x194)]['cssText'] = _0xaf06db(0x238); const _0x158ffc = document[_0xaf06db(0x1f4)](_0xaf06db(0x29a)); _0x158ffc[_0xaf06db(0x194)][_0xaf06db(0x27f)] = _0xaf06db(0x189); const _0x338741 = (_0x37c909, _0x47445f, _0xe2dbb5 = _0xaf06db(0x257)) => { const _0x176b3 = _0xaf06db, _0x7f00ff = document[_0x176b3(0x1f4)](_0x176b3(0x29a)); _0x7f00ff[_0x176b3(0x194)][_0x176b3(0x27f)] = 'padding:0.8rem;background:var(--surface-hover);border-radius:8px;border-left:3px\x20solid\x20' + _0xe2dbb5 + ';'; const _0x37c832 = createTextElement(_0x176b3(0x29a), _0x47445f); _0x37c832['style'][_0x176b3(0x27f)] = _0x176b3(0x1fb) + _0xe2dbb5 + ';'; const _0x13ca3e = createTextElement(_0x176b3(0x29a), _0x37c909); return _0x13ca3e[_0x176b3(0x194)]['cssText'] = _0x176b3(0x1bb), _0x7f00ff[_0x176b3(0x1db)](_0x37c832), _0x7f00ff[_0x176b3(0x1db)](_0x13ca3e), _0x7f00ff; }; _0x158ffc[_0xaf06db(0x1db)](_0x338741(_0xaf06db(0x1e2), _0x4bd3e6[_0xaf06db(0x291)][_0xaf06db(0x28f)](), _0xaf06db(0x1ad))), _0x158ffc[_0xaf06db(0x1db)](_0x338741(_0xaf06db(0x199), _0x3b6b76['length']['toString'](), _0xaf06db(0x16f))), _0x158ffc[_0xaf06db(0x1db)](_0x338741(_0xaf06db(0x1f1), _0xcca22f['length'][_0xaf06db(0x28f)](), '#F44336')), _0x158ffc['appendChild'](_0x338741('Muted\x20Users', _0x56784e[_0xaf06db(0x282)][_0xaf06db(0x28f)](), _0xaf06db(0x17d))); const _0x74643e = document['createElement']('hr'); _0x74643e[_0xaf06db(0x194)][_0xaf06db(0x27f)] = 'border:none;border-top:1px\x20solid\x20var(--border);margin:1rem\x200;'; const _0x25955f = document['createElement'](_0xaf06db(0x29a)); _0x25955f[_0xaf06db(0x194)][_0xaf06db(0x27f)] = _0xaf06db(0x259); const _0x5099be = createTextElement('h4', _0xaf06db(0x239)); _0x5099be[_0xaf06db(0x194)][_0xaf06db(0x27f)] = _0xaf06db(0x266); const _0x5af98d = Array[_0xaf06db(0x1e5)](_0x4bd3e6['docs'])['map'](_0x2a81fb => ({ ..._0x2a81fb['data'](), 'docId': _0x2a81fb['id'], 'msgCount': _0xccd026[_0x2a81fb[_0xaf06db(0x279)]()[_0xaf06db(0x1ca)]] || 0x0 }))[_0xaf06db(0x20c)](_0x4fedd0 => _0x4fedd0['name'])[_0xaf06db(0x26a)]((_0xe076d, _0x36e70e) => _0x36e70e[_0xaf06db(0x1dd)] - _0xe076d[_0xaf06db(0x1dd)]); _0x5af98d[_0xaf06db(0x1b7)]((_0x29e3af, _0x3365b2) => { const _0xbf9242 = _0xaf06db, _0x3a33b4 = document[_0xbf9242(0x1f4)](_0xbf9242(0x29a)), _0x446a7b = _0x29e3af[_0xbf9242(0x203)] && _0x29e3af[_0xbf9242(0x203)] > Date[_0xbf9242(0x264)](); _0x3a33b4[_0xbf9242(0x194)]['cssText'] = _0xbf9242(0x221) + (_0x29e3af['banned'] ? _0xbf9242(0x245) : _0x446a7b ? _0xbf9242(0x17d) : _0x29e3af['status'] === _0xbf9242(0x267) ? _0xbf9242(0x1ad) : _0xbf9242(0x190)) + ';'; const _0x423f6f = document[_0xbf9242(0x1f4)](_0xbf9242(0x29a)); _0x423f6f['style'][_0xbf9242(0x27f)] = _0xbf9242(0x17a); const _0xa3e15 = createTextElement('div', '#' + (_0x3365b2 + 0x1)); _0xa3e15[_0xbf9242(0x194)]['cssText'] = _0xbf9242(0x20a); const _0x48a199 = createTextElement('div', '' + safeUsername(_0x29e3af[_0xbf9242(0x170)], _0x29e3af[_0xbf9242(0x26c)])); _0x48a199[_0xbf9242(0x194)]['cssText'] = _0xbf9242(0x1eb) + (_0x29e3af['banned'] ? _0xbf9242(0x196) : ''); const _0x4f01fc = createTextElement(_0xbf9242(0x258), _0x29e3af[_0xbf9242(0x1c3)] ? 'ðŸš«' : _0x446a7b ? 'ðŸ”‡' : _0x29e3af[_0xbf9242(0x183)] === _0xbf9242(0x267) ? 'ðŸŸ¢' : 'âš«'); _0x4f01fc[_0xbf9242(0x194)][_0xbf9242(0x27f)] = _0xbf9242(0x1bc), _0x423f6f['appendChild'](_0xa3e15), _0x423f6f['appendChild'](_0x4f01fc), _0x423f6f[_0xbf9242(0x1db)](_0x48a199); const _0x4eefb2 = document['createElement'](_0xbf9242(0x29a)); _0x4eefb2[_0xbf9242(0x194)][_0xbf9242(0x27f)] = 'text-align:right;margin-right:1rem;'; const _0x4e9082 = createTextElement('div', '' + _0x29e3af[_0xbf9242(0x1dd)]); _0x4e9082['style']['cssText'] = _0xbf9242(0x298); const _0x41a140 = createTextElement(_0xbf9242(0x29a), 'messages'); _0x41a140[_0xbf9242(0x194)][_0xbf9242(0x27f)] = _0xbf9242(0x1de), _0x4eefb2['appendChild'](_0x4e9082), _0x4eefb2[_0xbf9242(0x1db)](_0x41a140); const _0x3559b1 = document[_0xbf9242(0x1f4)]('div'); _0x3559b1[_0xbf9242(0x194)][_0xbf9242(0x27f)] = _0xbf9242(0x1c7); if (_0x29e3af['uid'] !== me['uid']) { const _0x300be0 = document[_0xbf9242(0x1f4)](_0xbf9242(0x247)); _0x300be0['textContent'] = _0x29e3af[_0xbf9242(0x1c3)] ? _0xbf9242(0x24c) : _0xbf9242(0x215), _0x300be0[_0xbf9242(0x194)][_0xbf9242(0x27f)] = _0xbf9242(0x15d) + (_0x29e3af[_0xbf9242(0x1c3)] ? '#4CAF50' : _0xbf9242(0x245)) + _0xbf9242(0x297), _0x300be0['onclick'] = async _0x3d4023 => { const _0x3a660d = _0xbf9242; _0x3d4023[_0x3a660d(0x211)](); try { const _0x143f14 = !_0x29e3af[_0x3a660d(0x1c3)]; await updateDoc(doc(db, 'users', _0x29e3af[_0x3a660d(0x23b)]), { 'banned': _0x143f14, 'bannedAt': _0x143f14 ? Date[_0x3a660d(0x264)]() : null }), showStatusMessage(_0x29e3af[_0x3a660d(0x170)] + _0x3a660d(0x218) + (_0x143f14 ? 'banned' : _0x3a660d(0x16b)), _0x3a660d(0x1cf)), adminPanelBtn[_0x3a660d(0x16c)](); } catch (_0x47b31) { console[_0x3a660d(0x242)](_0x3a660d(0x274), _0x47b31), showStatusMessage(_0x3a660d(0x1c6), 'error'); } }; const _0x5352ca = document[_0xbf9242(0x1f4)](_0xbf9242(0x247)); _0x5352ca['textContent'] = _0x446a7b ? _0xbf9242(0x292) : 'Mute', _0x5352ca['style']['cssText'] = _0xbf9242(0x15d) + (_0x446a7b ? _0xbf9242(0x1ad) : _0xbf9242(0x17d)) + _0xbf9242(0x297), _0x5352ca['onclick'] = async _0x366227 => { const _0x245421 = _0xbf9242; _0x366227[_0x245421(0x211)](); try { const _0x24d1da = _0x446a7b ? 0x0 : Date[_0x245421(0x264)]() + 0x927c0; await updateDoc(doc(db, 'users', _0x29e3af[_0x245421(0x23b)]), { 'mutedUntil': _0x24d1da }), showStatusMessage(_0x29e3af[_0x245421(0x170)] + _0x245421(0x218) + (_0x446a7b ? _0x245421(0x25d) : 'muted\x20for\x2010\x20minutes'), _0x245421(0x1cf)), adminPanelBtn[_0x245421(0x16c)](); } catch (_0x4f1a46) { console[_0x245421(0x242)](_0x245421(0x1e7), _0x4f1a46), showStatusMessage(_0x245421(0x17e), 'error'); } }, _0x3559b1[_0xbf9242(0x1db)](_0x5352ca), _0x3559b1[_0xbf9242(0x1db)](_0x300be0); } _0x3a33b4['appendChild'](_0x423f6f), _0x3a33b4[_0xbf9242(0x1db)](_0x4eefb2), _0x3a33b4[_0xbf9242(0x1db)](_0x3559b1), _0x25955f[_0xbf9242(0x1db)](_0x3a33b4); }); const _0x143b63 = createTextElement(_0xaf06db(0x29a), _0xaf06db(0x1ed)); return _0x143b63[_0xaf06db(0x194)][_0xaf06db(0x27f)] = _0xaf06db(0x22b), _0x439712['appendChild'](_0x59eea1), _0x439712['appendChild'](_0x158ffc), _0x439712[_0xaf06db(0x1db)](_0x74643e), _0x439712[_0xaf06db(0x1db)](_0x5099be), _0x439712[_0xaf06db(0x1db)](_0x25955f), _0x439712[_0xaf06db(0x1db)](_0x143b63), _0x439712; }, () => { closeModal(); }); } catch (_0x22c2ed) { console[_0x1663d9(0x242)]('Admin\x20panel\x20error:', _0x22c2ed), showStatusMessage('Failed\x20to\x20load\x20admin\x20panel', 'error'); } }, adminKeyBtn['onclick'] = async () => { const _0xdfc811 = _0x28df0b; createSafeModal(_0xdfc811(0x289), () => { const _0x5c5700 = _0xdfc811, _0x170628 = document[_0x5c5700(0x1f4)]('div'), _0x3047b2 = document['createElement']('input'); _0x3047b2['id'] = 'adminKeyInput', _0x3047b2['className'] = 'input', _0x3047b2[_0x5c5700(0x148)] = _0x5c5700(0x140), _0x3047b2[_0x5c5700(0x15e)] = _0x5c5700(0x1d7), _0x3047b2[_0x5c5700(0x223)] = 0x64; const _0x20dd1b = createTextElement(_0x5c5700(0x29a), _0x5c5700(0x1f5)); return _0x20dd1b[_0x5c5700(0x194)][_0x5c5700(0x27f)] = _0x5c5700(0x141), _0x170628[_0x5c5700(0x1db)](_0x3047b2), _0x170628[_0x5c5700(0x1db)](_0x20dd1b), _0x170628; }, async () => { const _0x55c8b1 = _0xdfc811, _0x40f160 = sanitizeInput(document[_0x55c8b1(0x1e3)](_0x55c8b1(0x1a6))[_0x55c8b1(0x15f)], 0x64); if (!_0x40f160) return; try { const _0x7d90a3 = await getDocs(collection(db, _0x55c8b1(0x204))); let _0x5077fe = ![], _0x422794 = ![]; _0x7d90a3[_0x55c8b1(0x1b7)](_0x3e2bae => { const _0x26687e = _0x55c8b1, _0x35da86 = _0x3e2bae[_0x26687e(0x279)](); if (_0x35da86['key'] === _0x40f160 && _0x35da86[_0x26687e(0x21e)] === !![]) { _0x5077fe = !![]; if (_0x35da86[_0x26687e(0x21d)] === 'owner') _0x422794 = !![]; } }), _0x5077fe ? (await setDoc(doc(db, _0x55c8b1(0x244), me[_0x55c8b1(0x1ca)]), { 'uid': me[_0x55c8b1(0x1ca)], 'isOwner': _0x422794, 'grantedAt': serverTimestamp() }), isAdmin = !![], me[_0x55c8b1(0x16d)] = !![], me[_0x55c8b1(0x1a5)] = _0x422794, _0x422794 && (me[_0x55c8b1(0x170)] = _0x55c8b1(0x1f6), me[_0x55c8b1(0x26c)] = _0x55c8b1(0x15a), sessionStorage[_0x55c8b1(0x192)]('username', me[_0x55c8b1(0x170)]), sessionStorage[_0x55c8b1(0x192)](_0x55c8b1(0x177), me[_0x55c8b1(0x26c)])), await upsertUserProfile(), updateAdminUI(), showStatusMessage(_0x55c8b1(0x212), _0x55c8b1(0x1be)), closeModal()) : showStatusMessage('Invalid\x20admin\x20key', 'error'); } catch (_0x305d5f) { console[_0x55c8b1(0x242)](_0x55c8b1(0x241), _0x305d5f), showStatusMessage(_0x55c8b1(0x169), _0x55c8b1(0x242)); } }); }; const style = document[_0x28df0b(0x1f4)](_0x28df0b(0x194)); style['textContent'] = _0x28df0b(0x265), document['head'][_0x28df0b(0x1db)](style); if (me[_0x28df0b(0x170)]) me[_0x28df0b(0x1d9)] = avatarLetter(me[_0x28df0b(0x170)]);